<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Cyber Portal</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<style>
  /* reset */
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Roboto,Arial;background:#06060a;color:#e6f3ff;-webkit-font-smoothing:antialiased}
  /* keep decorative layers non-interactive */
  canvas, .bg-overlay, .scan { position:fixed; inset:0; z-index:0; pointer-events:none; }

  /* main container */
  .wrap { position:relative; z-index:2; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:18px; }

  .card {
    width:100%; max-width:980px; border-radius:14px; padding:14px;
    display:flex; gap:14px; align-items:stretch;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    box-shadow: 0 12px 48px rgba(0,0,0,0.6);
    border:1px solid rgba(124,92,255,0.06);
    flex-direction:row;
  }

  /* small screens: stack */
  @media (max-width:800px){
    .card{flex-direction:column; padding:12px}
  }

  /* visual column */
  .visual {
    flex:1; min-width:220px; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px;
    padding:14px; border-radius:10px; background:linear-gradient(135deg, rgba(124,92,255,0.03), rgba(0,212,255,0.02));
  }

  /* skull container (keeps 3D transform safe) */
  .skull-wrap {
    width:180px; height:180px; display:flex; align-items:center; justify-content:center;
    perspective:900px; -webkit-perspective:900px;
  }

  .skull {
    width:170px; height:170px; border-radius:12px; display:flex; align-items:center; justify-content:center;
    transform-style:preserve-3d; -webkit-transform-style:preserve-3d;
    animation:rotate 9s linear infinite;
    background: linear-gradient(180deg, rgba(124,92,255,0.12), rgba(0,212,255,0.05));
    box-shadow: 0 20px 50px rgba(2,6,23,0.6);
    pointer-events:none; /* decorative */
  }
  @keyframes rotate { 0%{transform:rotateX(6deg) rotateY(0)}50%{transform:rotateX(6deg) rotateY(180deg)}100%{transform:rotateX(6deg) rotateY(360deg)} }

  /* make actual image centered and responsive */
  .skull img { width:86%; height:86%; object-fit:contain; display:block; pointer-events:none; user-select:none; -webkit-user-drag:none; }

  .title { font-weight:800; font-size:16px; letter-spacing:0.6px; text-transform:uppercase; color:#e6f3ff; text-align:center }
  .subtitle { color:rgba(230,242,255,0.8); font-size:12px; text-align:center }

  /* gate panel */
  .panel {
    width:420px; max-width:46%; min-width:260px; padding:14px; border-radius:10px;
    background: linear-gradient(180deg, rgba(0,0,0,0.18), rgba(2,6,23,0.28));
    display:flex; flex-direction:column; gap:12px; justify-content:center;
  }

  @media (max-width:800px){
    .panel { max-width:100%; width:100%; min-width:unset; }
    .visual { order: -1; } /* put visual above panel on phones */
  }

  .muted{color:rgba(230,238,248,0.68); font-size:13px}
  label.small{font-size:13px;color:rgba(230,238,248,0.72)}

  /* big tap-friendly input */
  .input-row { display:flex; gap:10px; align-items:center; }
  input[type="password"]{
    flex:1; padding:14px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04);
    background:rgba(255,255,255,0.02); color:inherit; outline:none; font-size:16px;
    -webkit-appearance:none;
  }
  input[type="password"]::placeholder { color:rgba(255,255,255,0.35); }

  button.btn{
    padding:12px 14px; border-radius:10px; border:none; cursor:pointer; font-weight:800;
    background: linear-gradient(90deg,#7c5cff,#00d4ff);
    color:#041226; min-width:86px;
  }
  .hint{color:#ffb4b4;font-size:13px; min-height:18px}

  /* protected area */
  .protected { display:none; margin-top:12px; padding:12px; border-radius:10px; background:linear-gradient(90deg, rgba(0,0,0,0.12), rgba(2,6,23,0.2)); }
  .countdown { font-size:26px; font-weight:900; letter-spacing:1px; margin-top:8px }
  .small{font-size:13px;color:rgba(230,238,248,0.85) }

  /* make interactive elements above any decorative layers */
  input, button, .panel { position:relative; z-index:3; }

  /* helpful focus styles */
  input:focus { box-shadow:0 6px 24px rgba(0,212,255,0.08); border-color:rgba(0,212,255,0.18); }

  /* glitch heading */
  .glitch { font-weight:900; font-size:18px; color:#e6f3ff }
  .glitch::before, .glitch::after { content:attr(data-text); position:absolute; left:-9999px; } /* keep simple for mobile */

  /* ensure body tap highlight less intrusive */
  a, button { -webkit-tap-highlight-color: rgba(0,0,0,0); }

  /* small footer */
  .footer-hint { font-size:12px; color:rgba(230,238,248,0.52) }

</style>
</head>
<body>
  <!-- decorative matrix canvas (non-interactive) -->
  <canvas id="rain"></canvas>
  <div class="bg-overlay"></div>
  <div class="scan"></div>

  <div class="wrap">
    <div class="card" role="region" aria-label="Cyber portal">
      <!-- visual -->
      <div class="visual" aria-hidden="true">
        <div class="skull-wrap">
          <div class="skull" aria-hidden="true">
            <!-- replace src with your data-uri or external image -->
            <img id="skullImg" src="skull.png" alt="Skull" />
          </div>
        </div>
        <div class="title">☠️ CYBER PORTAL</div>
      </div>

      <!-- gate panel -->
      <div class="panel" id="gate" aria-labelledby="gateTitle">
        <div>
          <div class="glitch" data-text="SECURE ENTRY" id="gateTitle">SECURE ENTRY</div>
          <div class="muted" style="margin-top:6px">Enter access key to reveal the portal.</div>
        </div>

        <div style="margin-top:10px">
          <label for="pw" class="small">Password</label>
          <div class="input-row" style="margin-top:8px;">
            <input id="pw" type="password" inputmode="text" autocomplete="off" placeholder="Enter access key" aria-label="Password" />
            <button id="enter" class="btn" aria-label="Enter">Enter</button>
          </div>
          <div class="hint" id="hint" aria-live="polite"></div>
        </div>

        <div class="footer-hint">Tip: Press Enter to submit. The password is infront of you.</div>
      </div>

      <!-- protected content -->
      <div class="protected" id="protected" aria-hidden="true">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
          <div>
            <div class="glitch" data-text="ACCESS GRANTED">ACCESS GRANTED</div>
            <div class="small" style="margin-top:8px">Countdown to the scheduled event:</div>
            <div class="countdown" id="countdown">--:--:--:--</div>
            <div class="muted" id="endText"></div>
          </div>
          <div style="display:flex;flex-direction:column;gap:10px;align-items:flex-end">
            <div style="display:flex;gap:8px;align-items:center">
              <svg width="36" height="36" viewBox="0 0 24 24" aria-hidden="true"><path fill="#7c5cff" d="M12 2c-3 0-5 2-5 5 0 1 0 2 1 3-2 .5-3 2-3 4 0 2 2 4 5 4h4c3 0 5-2 5-4 0-2-1-3-3-4 1-1 1-2 1-3 0-3-2-5-5-5z"/></svg>
              <svg width="36" height="36" viewBox="0 0 24 24" aria-hidden="true"><path fill="#00d4ff" d="M12 2C8 2 6 4 6 7c0 1 1 2 1 3-2 1-3 2-3 4 0 3 3 6 8 6s8-3 8-6c0-2-1-3-3-4 0-1 1-2 1-3 0-3-2-5-5-5z"/></svg>
            </div>
          </div>
        </div>

        <div style="margin-top:12px;display:flex;gap:12px;align-items:center;flex-wrap:wrap">
          <div style="flex:1;min-width:180px">
            <div class="muted">Status</div>
            <div style="margin-top:6px">Portal state: <strong id="portalState">Open</strong></div>
          </div>
          <div style="flex:1;min-width:180px">
            <div class="muted">Action</div>
            <div style="margin-top:6px"><button id="lockBtn" class="btn">Lock</button></div>
          </div>
        </div>

      </div> <!-- protected -->

    </div> <!-- card -->
  </div> <!-- wrap -->

<script>
/* MOBILE-FRIENDLY single-file portal
   Password hash = SHA-256("access key")
   Hash used below: 728577d2bb50dc730cae01a35a46967b9b13c86989284e0bf9bd348a620204dd
   Target time: 2025-11-12 11:30 AM PST -> UTC 2025-11-12T19:30:00Z
*/

const PASSWORD_HASH = '728577d2bb50dc730cae01a35a46967b9b13c86989284e0bf9bd348a620204dd';
const TARGET_UTC = new Date('2025-11-12T09:00:00Z');

const pwInput = document.getElementById('pw');
const enterBtn = document.getElementById('enter');
const hint = document.getElementById('hint');
const protectedArea = document.getElementById('protected');
const gate = document.getElementById('gate');
const countdownEl = document.getElementById('countdown');
const endText = document.getElementById('endText');
const portalState = document.getElementById('portalState');
const lockBtn = document.getElementById('lockBtn');

// SHA-256 helper
function toHex(buffer){
  const b = new Uint8Array(buffer);
  return Array.from(b).map(x => x.toString(16).padStart(2,'0')).join('');
}
async function sha256hex(str){
  const enc = new TextEncoder();
  const data = enc.encode(str);
  const digest = await crypto.subtle.digest('SHA-256', data);
  return toHex(digest);
}

function showHint(msg, ok=false){
  hint.textContent = msg;
  hint.style.color = ok ? '#bfe6ff' : '#ff9b9b';
}

// reveal / lock
function revealPortal(){
  gate.style.display = 'none';
  protectedArea.style.display = 'block';
  sessionStorage.setItem('portal_auth','1');
  portalState.textContent = 'Open';
}
function lockPortal(){
  sessionStorage.removeItem('portal_auth');
  gate.style.display = 'block';
  protectedArea.style.display = 'none';
  pwInput.value = '';
  showHint('', true);
  portalState.textContent = 'Locked';
}

// check password
async function checkPassword(){
  const v = (pwInput.value || '').trim();
  if(!v){ showHint('Type the access key'); pwInput.focus(); return; }
  showHint('Verifying…', true);
  try{
    const h = await sha256hex(v);
    if(h === PASSWORD_HASH){
      showHint('Access granted', true);
      setTimeout(revealPortal, 250);
    } else {
      showHint('Wrong key — try again');
      pwInput.animate([{transform:'translateX(0)'},{transform:'translateX(-8px)'},{transform:'translateX(8px)'},{transform:'translateX(0)'}],{duration:300});
      pwInput.focus();
    }
  } catch(e){
    console.error(e);
    showHint('Verification error');
  }
}

enterBtn.addEventListener('click', checkPassword);
pwInput.addEventListener('keydown', e => { if(e.key === 'Enter') checkPassword(); });
lockBtn.addEventListener('click', lockPortal);

// restore session
if(sessionStorage.getItem('portal_auth') === '1'){
  revealPortal();
  portalState.textContent = 'Open';
} else {
  portalState.textContent = 'Locked';
}

// Countdown
function updateCountdown(){
  const now = new Date();
  let diff = Math.floor((TARGET_UTC - now)/1000);
  if(diff <= 0){
    countdownEl.textContent = '00:00:00:00';
    endText.innerHTML = 'Countdown reached — <a href="goat.html" style="color:#00d4ff;text-decoration:underline;">Click here</a>';
    clearInterval(cdTimer);
    return;
  }
  const days = Math.floor(diff/86400); diff %= 86400;
  const hrs = Math.floor(diff/3600); diff %= 3600;
  const mins = Math.floor(diff/60); const secs = diff % 60;
  const fmt = n => String(n).padStart(2,'0');
  countdownEl.textContent = `${fmt(days)}:${fmt(hrs)}:${fmt(mins)}:${fmt(secs)}`;
}
updateCountdown();
const cdTimer = setInterval(updateCountdown, 1000);

/* MATRIX RAIN (non-interactive) */
(function(){
  const canvas = document.getElementById('rain');
  const ctx = canvas.getContext('2d');
  canvas.style.pointerEvents = 'none'; // critical: don't block touches
  function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; init(); }
  window.addEventListener('resize', resize);
  let cols = [], fontSize = 16;
  function init(){
    fontSize = Math.max(12, Math.floor(Math.min(innerWidth, innerHeight) / 64) * 2 + 12);
    ctx.font = fontSize + 'px monospace';
    const count = Math.floor(innerWidth / fontSize);
    cols = Array.from({length:count}, () => Math.floor(Math.random()*innerHeight/fontSize));
  }
  const chars = 'ﾊﾐﾋｰｰｯｼﾘﾄｱｳ1234567890ABCDEF@#$%&*()[]<>';
  function frame(){
    ctx.fillStyle = 'rgba(0,0,0,0.12)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    for(let i=0;i<cols.length;i++){
      const x = i * fontSize;
      const y = cols[i] * fontSize;
      const ch = chars.charAt(Math.floor(Math.random()*chars.length));
      ctx.fillStyle = i%8===0 ? 'rgba(124,92,255,0.95)' : 'rgba(0,212,255,0.85)';
      ctx.fillText(ch, x, y);
      if(y > canvas.height && Math.random() > 0.975) cols[i] = 0;
      cols[i]++;
    }
    requestAnimationFrame(frame);
  }
  resize();
  frame();
})();

/* PHONE FOCUS HELPERS
   Some mobile browsers are picky when elements are inside transformed/animated parents.
   We add an additional touchstart that attempts to focus the input if it's the target area.
*/
(function(){
  const pw = pwInput;
  // if user taps on the panel area, focus input (useful on some Android/iOS)
  document.getElementById('gate').addEventListener('touchstart', (e)=>{
    // if the element tapped is the input or a child of input, do nothing (native)
    if(e.target === pw || pw.contains(e.target)) return;
    // otherwise focus input after a tiny delay
    setTimeout(()=>{ try{ pw.focus(); }catch{} }, 80);
  }, { passive:true });

  // Also focus when user taps the skull (visual) - small convenience
  document.querySelector('.skull-wrap').addEventListener('touchstart', ()=>{ setTimeout(()=>{ pw.focus(); }, 80); }, { passive:true });
})();

// make sure input gets initial focus on load (but not on mobile auto-popup)
window.addEventListener('load', ()=>{ setTimeout(()=>{ try{ if(!/Mobi|Android/i.test(navigator.userAgent)) pwInput.focus(); }catch{} }, 140); });

</script>
</body>
</html>
